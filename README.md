NOTE: I am not the author of this code, 
I have taken code form below github and practiced
https://github.com/jleetutorial/sparkTutorial

I have give youtube url also, good explaination


https://github.com/jleetutorial/sparkTutorial/blob/winutils/winutils.exe

https://www.youtube.com/watch?v=RsALKtZvqFo  (pycharm with spark)

apache spark for python:  https://www.youtube.com/watch?v=IQfG0faDrzE

https://www.youtube.com/watch?v=CoYIwoeQxMY&list=PLot-YkcC7wZ_2sxmRTZr2c121rjcaleqv

for windows download the winutils and set it as HADOOP_HOME and bin

winutils chmod 777 c:\tmp\hive

pyspark  for python

spark-shell  for scala

go to spark home to set the log level info to error

d:\Scala\spark-2.2.1-bin-hadoop2.7

go to "conf" folder open "log4j.properties"

#log4j.rootCategory=INFO, console
log4j.rootCategory=ERROR, console


https://academy.level-up.one/courses/apache-spark-with-python-big-data-with-pyspark-and-spark/lectures/5201149


Go to project Structure  
step 1: click "Add Content Root:"

add below one
D:\Scala\spark-2.2.1-bin-hadoop2.7\python

step 2: add below one

D:\Scala\spark-2.2.1-bin-hadoop2.7\python\lib\py4j-0.10.4-src.zip
